{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Distillation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Binary distillation assuming 100% separation on non-keys"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Distillation: D1\n",
      "ins...\n",
      "[0] feed\n",
      "    phase: 'l', T: 76.129 degC, P: 1 atm\n",
      "    flow: Water     0.39\n",
      "          Methanol  0.488\n",
      "          Glycerol  0.122\n",
      "          net       205 kmol/hr \n",
      "outs...\n",
      "[0] d1\n",
      "    phase: 'g', T: 64.91 degC, P: 1 atm\n",
      "    flow: Water     0.01\n",
      "          Methanol  0.99\n",
      "          net       100 kmol/hr \n",
      "[1] d2\n",
      "    phase: 'l', T: 100.06 degC, P: 1 atm\n",
      "    flow: Water     0.754\n",
      "          Methanol  0.00761\n",
      "          Glycerol  0.239\n",
      "          net       105 kmol/hr \n"
     ]
    }
   ],
   "source": [
    "from biosteam import Species, Stream\n",
    "from biosteam.units import Distillation\n",
    "\n",
    "# Set up stream\n",
    "Stream.species = Species('Water', 'Methanol', 'Glycerol')\n",
    "feed = Stream('feed', flow=(80, 100, 25))\n",
    "feed.T = feed.bubble_T()[0] # Feed at bubble point T\n",
    "\n",
    "# Set up column\n",
    "D1 = Distillation('D1', ins=feed,\n",
    "                  LHK=('Methanol', 'Water'),\n",
    "                  y_top=0.99, x_bot=0.01, k=2)\n",
    "D1.is_divided = True\n",
    "D1.simulate()\n",
    "\n",
    "# See all results\n",
    "D1.diagram()\n",
    "D1.show(T='degC', P='atm', fraction=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Distillation</th>\n",
       "      <th>Units</th>\n",
       "      <th>D1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Cooling water</th>\n",
       "      <th>Duty</th>\n",
       "      <td>kJ/hr</td>\n",
       "      <td>-4.87e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow</th>\n",
       "      <td>kmol/hr</td>\n",
       "      <td>3.33e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cost</th>\n",
       "      <td>USD/hr</td>\n",
       "      <td>1.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Low pressure steam</th>\n",
       "      <th>Duty</th>\n",
       "      <td>kJ/hr</td>\n",
       "      <td>9.04e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow</th>\n",
       "      <td>kmol/hr</td>\n",
       "      <td>232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cost</th>\n",
       "      <td>USD/hr</td>\n",
       "      <td>55.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"14\" valign=\"top\">Design</th>\n",
       "      <th>Theoretical feed stage</th>\n",
       "      <td></td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Theoretical stages</th>\n",
       "      <td></td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Minimum reflux</th>\n",
       "      <td>Ratio</td>\n",
       "      <td>0.687</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Reflux</th>\n",
       "      <td>Ratio</td>\n",
       "      <td>1.37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier stages</th>\n",
       "      <td></td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper stages</th>\n",
       "      <td></td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier height</th>\n",
       "      <td>ft</td>\n",
       "      <td>27.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper height</th>\n",
       "      <td>ft</td>\n",
       "      <td>67.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier diameter</th>\n",
       "      <td>ft</td>\n",
       "      <td>7.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper diameter</th>\n",
       "      <td>ft</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier wall thickness</th>\n",
       "      <td>in</td>\n",
       "      <td>0.312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper wall thickness</th>\n",
       "      <td>in</td>\n",
       "      <td>0.438</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier weight</th>\n",
       "      <td>lb</td>\n",
       "      <td>1.49e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper weight</th>\n",
       "      <td>lb</td>\n",
       "      <td>1.19e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"6\" valign=\"top\">Cost</th>\n",
       "      <th>Rectifier trays</th>\n",
       "      <td>USD</td>\n",
       "      <td>2.1e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper trays</th>\n",
       "      <td>USD</td>\n",
       "      <td>2.63e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rectifier tower</th>\n",
       "      <td>USD</td>\n",
       "      <td>1.25e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stripper tower</th>\n",
       "      <td>USD</td>\n",
       "      <td>1.2e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Condenser</th>\n",
       "      <td>USD</td>\n",
       "      <td>3.34e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Boiler</th>\n",
       "      <td>USD</td>\n",
       "      <td>2.6e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Purchase cost</th>\n",
       "      <th></th>\n",
       "      <td>USD</td>\n",
       "      <td>3.52e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Utility cost</th>\n",
       "      <th></th>\n",
       "      <td>USD/hr</td>\n",
       "      <td>56.9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Distillation                                   Units        D1\n",
       "Cooling water      Duty                        kJ/hr -4.87e+06\n",
       "                   Flow                      kmol/hr  3.33e+03\n",
       "                   Cost                       USD/hr      1.62\n",
       "Low pressure steam Duty                        kJ/hr  9.04e+06\n",
       "                   Flow                      kmol/hr       232\n",
       "                   Cost                       USD/hr      55.2\n",
       "Design             Theoretical feed stage                    4\n",
       "                   Theoretical stages                       13\n",
       "                   Minimum reflux              Ratio     0.687\n",
       "                   Reflux                      Ratio      1.37\n",
       "                   Rectifier stages                         10\n",
       "                   Stripper stages                          37\n",
       "                   Rectifier height               ft      27.3\n",
       "                   Stripper height                ft      67.1\n",
       "                   Rectifier diameter             ft      7.84\n",
       "                   Stripper diameter              ft         3\n",
       "                   Rectifier wall thickness       in     0.312\n",
       "                   Stripper wall thickness        in     0.438\n",
       "                   Rectifier weight               lb  1.49e+04\n",
       "                   Stripper weight                lb  1.19e+04\n",
       "Cost               Rectifier trays               USD   2.1e+04\n",
       "                   Stripper trays                USD  2.63e+04\n",
       "                   Rectifier tower               USD  1.25e+05\n",
       "                   Stripper tower                USD   1.2e+05\n",
       "                   Condenser                     USD  3.34e+04\n",
       "                   Boiler                        USD   2.6e+04\n",
       "Purchase cost                                    USD  3.52e+05\n",
       "Utility cost                                  USD/hr      56.9"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "D1.results()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
