
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>biosteam.units.multi_effect_evaporator &#8212; BioSTEAM 0.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">BioSTEAM 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for biosteam.units.multi_effect_evaporator</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Aug 23 21:43:13 2018</span>

<span class="sd">@author: yoelr</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Stream</span><span class="p">,</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">brentq</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">Evaporator_PV</span><span class="p">,</span> <span class="n">Evaporator_PQin</span><span class="p">,</span> <span class="n">Pump</span><span class="p">,</span> <span class="n">Mixer</span><span class="p">,</span> <span class="n">HXutility</span>
<span class="kn">from</span> <span class="nn">.designtools</span> <span class="k">import</span> <span class="n">vacuum_system</span>
<span class="kn">import</span> <span class="nn">ht</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>

<span class="c1"># Table 22.32 Product process and design (pg 592)</span>
<span class="c1"># Name: (&#39;Area range (m2)&#39;, &#39;Cost(A) (USD)&#39;, &#39;U (kJ/(hr*m2*K)))&#39;, &#39;Material&#39;)</span>
<span class="n">evaporators</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Horizontal tube&#39;</span><span class="p">:</span> 
                    <span class="p">((</span><span class="mf">9.29</span><span class="p">,</span> <span class="mf">743.224</span><span class="p">),</span>
                     <span class="k">lambda</span> <span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">:</span> <span class="n">CE</span><span class="o">*</span><span class="mf">2.304</span><span class="o">*</span><span class="n">A</span><span class="o">**</span><span class="mf">0.53</span><span class="p">,</span>
                     <span class="mf">4906.02</span><span class="p">,</span>
                     <span class="s1">&#39;Carbon steel&#39;</span><span class="p">),</span>
               <span class="s1">&#39;Long-tube vertical&#39;</span><span class="p">:</span>
                   <span class="p">((</span><span class="mf">9.29</span><span class="p">,</span> <span class="mf">743.224</span><span class="p">),</span>
                    <span class="k">lambda</span> <span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">:</span> <span class="n">CE</span><span class="o">*</span><span class="mf">3.086</span><span class="o">*</span><span class="n">A</span><span class="o">**</span><span class="mf">0.55</span><span class="p">,</span>
                    <span class="mf">8176.699</span><span class="p">,</span>
                    <span class="s1">&#39;Carbon steel&#39;</span><span class="p">),</span>
               <span class="s1">&#39;Forced circulation&#39;</span><span class="p">:</span> 
                   <span class="p">((</span><span class="mf">13.935</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span>
                    <span class="k">lambda</span> <span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">:</span> <span class="n">CE</span><span class="o">/</span><span class="mi">500</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">8.2986</span> <span class="o">+</span> <span class="mf">0.5329</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="mf">0.0929</span><span class="p">)</span><span class="o">-</span><span class="mf">0.000196</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="mf">0.0929</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
                    <span class="mf">10731.918</span><span class="p">,</span>
                    <span class="s1">&#39;Carbon steel&#39;</span><span class="p">),</span>
               <span class="s1">&#39;Falling film&#39;</span><span class="p">:</span> 
                   <span class="p">((</span><span class="mf">13.935</span><span class="p">,</span> <span class="mf">371.612</span><span class="p">),</span>
                    <span class="k">lambda</span> <span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">:</span> <span class="n">CE</span><span class="o">*</span><span class="mf">7.416</span><span class="o">*</span><span class="n">A</span><span class="o">**</span><span class="mf">0.55</span><span class="p">,</span>
                    <span class="mf">10220.874</span><span class="p">,</span>
                    <span class="s1">&#39;Stainless steel tubes/Carbon steel shell&#39;</span><span class="p">)}</span>


<div class="viewcode-block" id="MultiEffectEvaporator"><a class="viewcode-back" href="../../../MultiEffectEvaporator.html#biosteam.MultiEffectEvaporator">[docs]</a><span class="k">class</span> <span class="nc">MultiEffectEvaporator</span><span class="p">(</span><span class="n">Unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates evaporatorators with pressures given by P (a list of pressures). Adjusts first evaporator vapor fraction to satisfy an overall fraction evaporated. All evaporators after the first have zero duty. Condenses the vapor coming out of the last evaporator. Pumps all liquid streams to prevent back flow in later parts. All liquid evaporated is ultimately recondensed. Cost is based on required heat transfer area. Vacuum system is based on air leakage. Air leakage is based on volume, as given by residence time `tau` and flow rate to each evaporator.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        **component:** *[str]* Component being evaporated</span>
<span class="sd">         </span>
<span class="sd">        **P:** *[tuple]* Pressures describing each evaporator (Pa)</span>
<span class="sd">         </span>
<span class="sd">        **V:** *[float]* Overall molar fraction of component evaporated</span>
<span class="sd">         </span>
<span class="sd">        **P_liq:** *[tuple]* Liquid pressure after pumping (Pa)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Area&#39;</span><span class="p">:</span> <span class="s1">&#39;m^2&#39;</span><span class="p">,</span>
              <span class="s1">&#39;Volume&#39;</span><span class="p">:</span> <span class="s1">&#39;m^3&#39;</span><span class="p">}</span>
    <span class="n">_has_power_utility</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">_N_heat_utilities</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;Multi-Effect Evaporator&#39;</span>
    <span class="n">_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;component&#39;</span><span class="p">:</span> <span class="s1">&#39;Water&#39;</span><span class="p">,</span>
               <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">101325</span><span class="p">,),</span>  
               <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> 
               <span class="s1">&#39;P_liq&#39;</span><span class="p">:</span> <span class="mi">101325</span><span class="p">}</span>

    <span class="c1">#: Residence time (hr)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="mf">0.30</span>

    <span class="c1"># Evaporator type</span>
    <span class="n">_Type</span> <span class="o">=</span> <span class="s1">&#39;Forced circulation&#39;</span>
    
    <span class="c1"># Data for simmulation and costing</span>
    <span class="n">_evap_data</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="n">_Type</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaporation type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Type</span>
    <span class="nd">@Type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evap_type</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_evap_data</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="n">evap_type</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">evaporators</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">11</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Evaporator type must be one of the following: </span><span class="si">{dummy}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Type</span> <span class="o">=</span> <span class="n">evap_type</span>

    <span class="k">def</span> <span class="nf">_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Unpack</span>
        <span class="n">component</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">P_liq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;component&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;P_liq&#39;</span><span class="p">))</span>
        <span class="n">out_wt_solids</span><span class="p">,</span> <span class="n">liq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outs</span>
        
        <span class="c1"># Create components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_N_evap</span> <span class="o">=</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="c1"># Number of evaporators</span>
        <span class="n">Stream</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">liq</span><span class="o">.</span><span class="n">species</span>
        <span class="n">evap0</span> <span class="o">=</span> <span class="n">Evaporator_PV</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">outs</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                             <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="n">evaporators</span> <span class="o">=</span> <span class="p">[</span><span class="n">evap0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">evap</span> <span class="o">=</span> <span class="n">Evaporator_PQin</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">outs</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                                   <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Qin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">evaporators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evap</span><span class="p">)</span>
        <span class="n">condenser</span> <span class="o">=</span> <span class="n">HXutility</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">outs</span><span class="o">=</span><span class="n">Stream</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">V</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">evap0</span><span class="o">.</span><span class="n">_heat_utilities</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">condenser</span><span class="o">.</span><span class="n">_heat_utilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heat_utilities</span>
        <span class="n">mixer</span> <span class="o">=</span> <span class="n">Mixer</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">outs</span><span class="o">=</span><span class="n">Stream</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        
        <span class="k">def</span> <span class="nf">V_error</span><span class="p">(</span><span class="n">v1</span><span class="p">):</span>
            <span class="c1"># Run first evaporator</span>
            <span class="n">v_test</span> <span class="o">=</span> <span class="n">v1</span>
            <span class="n">evap0</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span>
            <span class="n">evap0</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>
            <span class="c1"># Put liquid first, then vapor side stream</span>
            <span class="n">ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">evap0</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">evap0</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="n">evap</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">evap</span><span class="o">.</span><span class="n">ins</span> <span class="o">=</span> <span class="n">ins</span>
                <span class="n">evap</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>
                <span class="n">v_test</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v_test</span><span class="p">)</span> <span class="o">*</span> <span class="n">evap</span><span class="o">.</span><span class="n">_V</span>
                <span class="c1"># Put liquid first, then vapor side stream</span>
                <span class="n">ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">V</span> <span class="o">-</span> <span class="n">v_test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_V_error</span> <span class="o">=</span> <span class="n">V_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;evaporators&#39;</span><span class="p">:</span> <span class="n">evaporators</span><span class="p">,</span>
                           <span class="s1">&#39;condenser&#39;</span><span class="p">:</span> <span class="n">condenser</span><span class="p">,</span>
                           <span class="s1">&#39;mixer&#39;</span><span class="p">:</span> <span class="n">mixer</span><span class="p">}</span>
        

    <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">component</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">P_liq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;component&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;P_liq&#39;</span><span class="p">))</span>
        <span class="n">out_wt_solids</span><span class="p">,</span> <span class="n">liq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outs</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ins</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_evap</span>  <span class="c1"># Number of evaporators</span>

        <span class="c1"># Set-up components</span>
        <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span>
        <span class="n">evaporators</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="s1">&#39;evaporators&#39;</span><span class="p">]</span>
        <span class="n">evaporators</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">Stream</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ins</span><span class="p">]</span>
        <span class="n">condenser</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="s1">&#39;condenser&#39;</span><span class="p">]</span>
        <span class="n">mixer</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="s1">&#39;mixer&#39;</span><span class="p">]</span>
        <span class="n">brentq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_V_error</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.9909</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
        
        <span class="c1"># Condensing vapor from last effector</span>
        
        <span class="n">outs_vap</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">condenser</span><span class="o">.</span><span class="n">ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">outs_vap</span><span class="p">]</span>
        <span class="n">condenser</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>
        <span class="n">outs_liq</span> <span class="o">=</span> <span class="p">[</span><span class="n">condenser</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># list containing all output liquids</span>

        <span class="c1"># Unpack other output streams</span>
        <span class="n">out_wt_solids</span><span class="o">.</span><span class="n">copylike</span><span class="p">(</span><span class="n">evaporators</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">evap</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">outs_liq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># Mix liquid streams</span>
        <span class="n">mixer</span><span class="o">.</span><span class="n">ins</span> <span class="o">=</span> <span class="n">outs_liq</span>
        <span class="n">mixer</span><span class="o">.</span><span class="n">_run</span><span class="p">()</span>
        <span class="n">liq</span><span class="o">.</span><span class="n">copylike</span><span class="p">(</span><span class="n">mixer</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_lazy_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">feed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">out_wt_solids</span><span class="p">,</span> <span class="n">liq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outs</span>
        <span class="n">component</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;component&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">))</span>

        <span class="n">component_pos</span> <span class="o">=</span> <span class="n">feed</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">ID_index_dictionary</span><span class="p">[</span><span class="n">component</span><span class="p">]</span>
        <span class="n">liq</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="n">component_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">feed</span><span class="o">.</span><span class="n">mol</span><span class="p">[</span><span class="n">component_pos</span><span class="p">]</span>
        <span class="n">out_wt_solids</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">feed</span><span class="o">.</span><span class="n">mol</span> <span class="o">-</span> <span class="n">liq</span><span class="o">.</span><span class="n">mol</span>
        
    <span class="k">def</span> <span class="nf">_design</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This functions also finds the cost</span>
        <span class="n">A_range</span><span class="p">,</span> <span class="n">C_func</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evap_data</span>
        <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span>
        <span class="n">evaporators</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="s1">&#39;evaporators&#39;</span><span class="p">]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span>
        <span class="n">Design</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Design&#39;</span><span class="p">]</span>
        <span class="n">Cost</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Cost&#39;</span><span class="p">]</span>
        <span class="n">CE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CEPCI</span>
        
        <span class="n">evap0</span> <span class="o">=</span> <span class="n">evaporators</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">hu</span> <span class="o">=</span> <span class="n">evap0</span><span class="o">.</span><span class="n">_heat_utilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">duty</span> <span class="o">=</span> <span class="n">evap0</span><span class="o">.</span><span class="n">_H_out</span> <span class="o">-</span> <span class="n">evap0</span><span class="o">.</span><span class="n">_H_in</span>
        <span class="n">hu</span><span class="p">(</span><span class="n">duty</span><span class="p">,</span> <span class="n">evap0</span><span class="o">.</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">evap0</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">duty</span><span class="p">)</span>
        <span class="n">Tci</span> <span class="o">=</span> <span class="n">evap0</span><span class="o">.</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">Tco</span> <span class="o">=</span> <span class="n">evap0</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">Th</span> <span class="o">=</span> <span class="n">evap0</span><span class="o">.</span><span class="n">_heat_utilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_fresh</span><span class="o">.</span><span class="n">T</span>
        <span class="n">LMTD</span> <span class="o">=</span> <span class="n">ht</span><span class="o">.</span><span class="n">LMTD</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">Tci</span><span class="p">,</span> <span class="n">Tco</span><span class="p">)</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">HXutility</span><span class="o">.</span><span class="n">_calc_area</span><span class="p">(</span><span class="n">LMTD</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">ft</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evap_costs</span> <span class="o">=</span> <span class="n">evap_costs</span> <span class="o">=</span> <span class="p">[</span><span class="n">C_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">)]</span>
        
        <span class="c1"># Find condenser requirements</span>
        <span class="n">condenser</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="s1">&#39;condenser&#39;</span><span class="p">]</span>
        <span class="n">condenser</span><span class="o">.</span><span class="n">_design</span><span class="p">()</span>
        <span class="n">Cost</span><span class="p">[</span><span class="s1">&#39;Condenser&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">condenser</span><span class="o">.</span><span class="n">_cost</span><span class="p">()[</span><span class="s1">&#39;Heat exchanger&#39;</span><span class="p">]</span>
        
        <span class="c1"># Find area and cost of evaporators</span>
        <span class="n">As</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">evap</span> <span class="ow">in</span> <span class="n">evaporators</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">evap</span><span class="o">.</span><span class="n">_Qin</span>
            <span class="n">Tc</span> <span class="o">=</span> <span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
            <span class="n">Th</span> <span class="o">=</span> <span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
            <span class="n">LMTD</span> <span class="o">=</span> <span class="n">Th</span> <span class="o">-</span> <span class="n">Tc</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">HXutility</span><span class="o">.</span><span class="n">_calc_area</span><span class="p">(</span><span class="n">LMTD</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">ft</span><span class="p">)</span>
            <span class="n">As</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">A_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="n">A_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;WARNING, area requirement (</span><span class="si">{A}</span><span class="s1">) is out of range, </span><span class="si">{A_range}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">evap_costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">C_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">CE</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_As</span> <span class="o">=</span> <span class="n">As</span>
        <span class="n">Design</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">As</span><span class="p">)</span>
        <span class="n">Design</span><span class="p">[</span><span class="s1">&#39;Volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_evap</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">volnet</span>
        <span class="n">Cost</span><span class="p">[</span><span class="s1">&#39;Evaporators&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">evap_costs</span><span class="p">)</span>
        
        <span class="c1"># Calculate power</span>
        <span class="n">power</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">vacuum_system</span><span class="p">(</span><span class="n">massflow</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">volflow</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="n">P_suction</span><span class="o">=</span><span class="n">evap</span><span class="o">.</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">vol</span><span class="o">=</span><span class="n">vol</span><span class="p">,</span>
                                    <span class="n">vacuum_system_preference</span><span class="o">=</span><span class="s1">&#39;Liquid-ring pump&#39;</span><span class="p">)</span>
        <span class="n">Cost</span><span class="p">[</span><span class="s1">&#39;Vacuum liquid-ring pump&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_utility</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Design</span>

    <span class="k">def</span> <span class="nf">_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">[</span><span class="s1">&#39;Cost&#39;</span><span class="p">]</span></div>
        
        
        
        
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">BioSTEAM 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Yoel Cortes-Pena and Guest Group.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>